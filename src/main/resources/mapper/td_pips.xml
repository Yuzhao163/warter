<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!--如果id不设置成自动递增的，但是如果不加递增符号的话，就会报如下的错误
Field 'id' doesn't have a default value] with root cause-->

<!--  <insert id="insertUser">
      insert into user(username,password) values(#{username},#{password});
  </insert>-->
<mapper namespace="com.water.water.dao.td_PipesDao">
    <resultMap id="BaseResultMap" type="com.water.water.pojo.td_PIPs">
        <result column="PipID" property="PipID" jdbcType="VARCHAR"/>
        <result column="PipName" property="PipName" jdbcType="VARCHAR"/>
        <result column="PipDesc" property="PipDesc" jdbcType="VARCHAR"/>
        <result column="PipLeader" property="PipLeader" jdbcType="VARCHAR"/>
        <result column="PipLeadPhone" property="PipLeadPhone" jdbcType="VARCHAR"/>
        <result column="AreaID" property="AreaID" jdbcType="VARCHAR"/>
        <result column="PipCreateDate" property="PipCreateDate" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="getPips" resultMap="BaseResultMap">
        select PipName,PipID from td_pips where AreaID = #{AreaID};
    </select>

    <select id="getPipsByAreaID" resultMap="BaseResultMap">
        select PipName,PipID from td_pips where AreaID = #{AreaID};
    </select>

    <select id="getPipByAreaID" resultMap="BaseResultMap">
        select PipName,PipID from td_pips where AreaID = #{AreaID};
    </select>

    <!--    根据管线id查询管线-->
    <select id="getPipNameByPipID" resultType="String">
        select PipName from td_pips where PipID = #{PipID}
    </select>

<!--    &lt;!&ndash;根据管线查区域&ndash;&gt;-->
<!--    <select id="getAreasIdByPips" resultMap="BaseResultMap">-->
<!--        select AreaID from td_pips where PipID=#{PipID};-->
<!--    </select>-->

    <!--    返回全部管线信息-->
    <select id="getPipList" resultMap="BaseResultMap">
        select * from td_pips
    </select>

<!--  更新管线名称和电话 -->
    <update id="updatePipLeader">
        update td_pips set PipLeader = #{pipLeader},PipLeadPhone = #{pipLeadPhone} where PipLeader = #{beforeName};
    </update>

<!--  根据管线id获取管线id与名称  -->
    <select id="getPIDNameByPID" resultMap="BaseResultMap">
        select PipID,PipName from td_pips where PipID = #{PipID};
    </select>


    <select id="getPipSize" resultType="Integer">
        select count(PipID) from td_pips;
    </select>

    <select id="getAllPips" resultMap="BaseResultMap">
        select * from td_pips
        <if test="page!=null and size!=null">
            limit #{page},#{size};
        </if>
    </select>

    <!--5.9增加管线-->
    <insert id="addPips">
    insert into td_pips(PipID,PipName,PipCreateDate) values (#{PipID},#{PipName},now());
</insert>

    <!--5.9根据管线名称查询是否存在同名管线-->
    <select id="ifSameNamePip" resultType="String">
    select * from td_pips where PipName = #{PipName};
</select>

    <!--5.9判断在数据库中是否存在相同的PipID-->
    <select id="getByPipId" resultType="String">
    select * from td_pips where PipID = #{PipID};
</select>

    <!--5.9删除管线-->
    <delete id="deletePip">
    delete from td_pips where PipID = #{PipID};
</delete>

    <!--5.9更新管线-->
    <update id="updatePips">
    update td_pips set PipName = #{PipName} where PipID = #{PipID};
</update>

    <!--判断名称是否重复-->
    <select id="getPipNameByName" resultType="String">
    select PipName from td_pips where PipName = #{PipName};
</select>







</mapper>
